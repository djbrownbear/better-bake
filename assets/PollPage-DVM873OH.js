import{j as e,u as B,a as D}from"./index-D1QAhWgw.js";import{r as T}from"./redux-vendor-D5VNH4HB.js";import{P as z,h as I}from"./PollHeader-DK2dHJsx.js";import{f as W,b as V}from"./helpers-D2giJciC.js";import{c as Y,N as q}from"./react-vendor-CtAogoA6.js";import"./fontawesome-Ba4mgrWh.js";const H=({id:c})=>{const k=B(),[r,p]=T.useState(!1),[O,g]=T.useState(!1),{poll:m,bakerOne:P,bakerTwo:U,authedUser:l}=D(o=>{const t=o.polls[c];if(!t)return{authedUser:o.authedUser,poll:null,bakerOne:"",bakerTwo:""};const v=t.optionOne.season,N=t.optionTwo.season,$=t.optionOne.episode,E=t.optionTwo.episode,A=v?o.bakers[v].baker[t.optionOne.baker].episodes[$].bakeURL:t.optionOne.imgURL,C=N?o.bakers[N].baker[t.optionTwo.baker].episodes[E].bakeURL:t.optionTwo.imgURL;return{authedUser:o.authedUser,poll:W(t,o.users[t.author],o.authedUser||""),bakerOne:A,bakerTwo:C}});if(!m||!l)return e.jsx(q,{to:"/error"});const b=async o=>{if(o.preventDefault(),!(!l||r)){p(!0);try{await k(I({qid:m.id,answer:o.currentTarget.id,authedUser:l})),g(!0),setTimeout(()=>g(!1),3e3)}catch(t){console.error("Error voting:",t)}finally{p(!1)}}},{avatar:S,name:R,optionOne:h,optionTwo:f,timestamp:L,hasVoted:a}=m,s=h.votes,w=h.text,n=f.votes,j=f.text,i=s.length+n.length,x=s.includes(l),u=n.includes(l);function y(o){let t;return o==="optionOne"?(t=s.length/i,V(t)):o==="optionTwo"?(t=n.length/i,V(t)):""}const d=(o,t)=>o===t?"tie":o>t?"winning":o<t?"losing":"";return e.jsxs("div",{className:"max-w-[65em] mx-auto mb-40 px-4 py-8",children:[O&&e.jsx("div",{role:"alert","aria-live":"polite",className:"bg-green-50 border-l-4 border-green-500 text-green-800 p-4 mb-6 rounded-lg",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("svg",{className:"w-6 h-6 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),e.jsx("p",{className:"font-semibold",children:"Vote recorded successfully!"})]})}),e.jsx(z,{avatar:S,name:R,timestamp:L}),e.jsx("h2",{className:"text-3xl font-bold text-center my-6",children:"Who Baked It Better?"}),e.jsxs("div",{className:"flex flex-col md:flex-row justify-between gap-6 md:gap-8 w-full mt-8",children:[e.jsx("div",{className:"flex-1 p-4 md:p-6 rounded-lg border-2 transition-all "+(x?"border-green-500 bg-green-50 shadow-lg":"border-gray-300 hover:border-gray-400")+(r?" opacity-75":""),children:e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[e.jsx("img",{className:"w-full h-auto max-h-64 md:max-h-96 object-contain mb-4",src:P,alt:"","aria-hidden":"true"}),e.jsx("h3",{className:"text-xl md:text-2xl font-bold text-center my-4",children:w}),x&&e.jsx("div",{className:"bg-green-600 text-white px-3 py-1 rounded-full text-sm font-semibold mb-2",children:"Your Vote"}),e.jsx("button",{id:"optionOne",className:"w-32 py-2.5 px-4 border-none bg-secondary hover:bg-amber-200 disabled:bg-gray-300 disabled:cursor-not-allowed text-gray-900 font-semibold rounded-lg transition-all cursor-pointer focus:outline-none focus:ring-2 focus:ring-amber-500 focus:ring-offset-2 active:scale-95 disabled:active:scale-100",onClick:o=>b(o),type:"button",disabled:a||r,"aria-label":`Vote for ${w}`,"aria-pressed":x,children:r?"Voting...":"Vote"}),a&&e.jsxs("p",{className:"flex flex-col items-center mt-4 text-lg font-semibold "+(d(s.length,n.length)==="winning"?"text-green-600":d(s.length,n.length)==="losing"?"text-red-600":"text-gray-600"),children:[e.jsx("span",{children:`${s.length} out of ${i} votes`}),e.jsx("span",{children:y("optionOne")})]})]})}),e.jsx("div",{className:"flex-1 p-4 md:p-6 rounded-lg border-2 transition-all "+(u?"border-green-500 bg-green-50 shadow-lg":"border-gray-300 hover:border-gray-400")+(r?" opacity-75":""),children:e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[e.jsx("img",{className:"w-full h-auto max-h-64 md:max-h-96 object-contain mb-4",src:U,alt:"","aria-hidden":"true"}),e.jsx("h3",{className:"text-xl md:text-2xl font-bold text-center my-4",children:j}),u&&e.jsx("div",{className:"bg-green-600 text-white px-3 py-1 rounded-full text-sm font-semibold mb-2",children:"Your Vote"}),e.jsx("button",{id:"optionTwo",className:"w-32 py-2.5 px-4 border-none bg-secondary hover:bg-amber-200 disabled:bg-gray-300 disabled:cursor-not-allowed text-gray-900 font-semibold rounded-lg transition-all cursor-pointer focus:outline-none focus:ring-2 focus:ring-amber-500 focus:ring-offset-2 active:scale-95 disabled:active:scale-100",onClick:o=>b(o),type:"button",disabled:a||r,"aria-label":`Vote for ${j}`,"aria-pressed":u,children:r?"Voting...":"Vote"}),a&&e.jsxs("p",{className:"flex flex-col items-center mt-4 text-lg font-semibold "+(d(n.length,s.length)==="winning"?"text-green-600":d(n.length,s.length)==="losing"?"text-red-600":"text-gray-600"),children:[e.jsx("span",{children:`${n.length} out of ${i} votes`}),e.jsx("span",{children:y("optionTwo")})]})]})})]})]})},X=()=>{const{id:c}=Y();return e.jsx(H,{id:c||""})};export{X as default};
//# sourceMappingURL=PollPage-DVM873OH.js.map
