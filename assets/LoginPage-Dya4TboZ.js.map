{"version":3,"file":"LoginPage-Dya4TboZ.js","sources":["../../src/components/LoginPage.tsx"],"sourcesContent":["import { useState, useRef, useEffect } from \"react\";\r\nimport React from 'react';\r\nimport { Navigate, useLocation } from \"react-router-dom\";\r\nimport { setAuthedUser } from \"../reducers/authedUser\";\r\nimport { useAppSelector, useAppDispatch } from \"../store/hooks\";\r\n\r\nconst LoginPage: React.FC = () => {\r\n  const { state } = useLocation() as { state?: { path?: string } };\r\n  const dispatch = useAppDispatch();\r\n  const users = useAppSelector(state => state.users);\r\n  const [success, setSuccess] = useState(false);\r\n  const [error, setError] = useState(false);\r\n  const [errorUserPwd, setErrorUserPwd] = useState(false);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const usernameRef = useRef<HTMLInputElement>(null);\r\n  const passwordRef = useRef<HTMLInputElement>(null);\r\n\r\n  useEffect(() => {\r\n    if (usernameRef.current) usernameRef.current.value = '';\r\n    if (passwordRef.current) passwordRef.current.value = '';\r\n  },[])\r\n\r\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    // Input values are automatically stored in refs\r\n  }\r\n\r\n  const handleSubmit = (e: React.FormEvent<HTMLFormElement> | React.MouseEvent<HTMLButtonElement>) => {\r\n    e.preventDefault();\r\n    setIsLoading(true);\r\n\r\n    // Simulate async operation for better UX\r\n    setTimeout(() => {\r\n      const username = usernameRef.current?.value;\r\n      const password = passwordRef.current?.value;\r\n      const user = users[username || ''];\r\n\r\n      if (user && user.password === password ){\r\n        setSuccess(true);\r\n        setError(false);\r\n        setErrorUserPwd(false);\r\n        dispatch(setAuthedUser(user.id));\r\n      } else if ( !username || !password) {\r\n        setError(true);\r\n        setSuccess(false);\r\n        setErrorUserPwd(false);\r\n        setIsLoading(false);\r\n      } else if (!user || user.password !== password ){\r\n        setErrorUserPwd(true);\r\n        setError(false);\r\n        setSuccess(false);\r\n        setIsLoading(false);\r\n      } else {\r\n        setErrorUserPwd(false);\r\n        setError(false);\r\n        setSuccess(false);\r\n        setIsLoading(false);\r\n      }\r\n    }, 300);\r\n  }\r\n\r\n  const handleDemoLogin = (e: React.MouseEvent<HTMLButtonElement>) => {\r\n    e.preventDefault();\r\n\r\n    // NOT for production use\r\n    // choose a random user to login as a demo user\r\n    const demoUser = Object.keys(users)[Math.floor(Math.random() * (Object.keys(users).length))];\r\n    if (usernameRef.current) usernameRef.current.value = demoUser;\r\n    if (passwordRef.current) passwordRef.current.value = users[demoUser].password;\r\n    handleSubmit(e);\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-primary flex items-center justify-center p-4\">\r\n      <div className=\"w-full max-w-md\">\r\n        {success && (\r\n          <Navigate to={(state?.path || \"/dashboard\")} /> // if successful, take user to homepage or page prior to login\r\n          )\r\n        }\r\n        {error &&\r\n            <div \r\n              role=\"alert\" \r\n              aria-live=\"assertive\" \r\n              data-testid=\"error-header\" \r\n              className=\"text-red-600 bg-red-50 border border-red-200 rounded-lg text-center p-4 mb-4 font-semibold\"\r\n            >\r\n              Error: Please ensure all fields are filled out.\r\n            </div>\r\n        }\r\n        {errorUserPwd &&\r\n            <div \r\n              role=\"alert\" \r\n              aria-live=\"assertive\" \r\n              data-testid=\"errorUserPwd-header\" \r\n              className=\"text-red-600 bg-red-50 border border-red-200 rounded-lg text-center p-4 mb-4 font-semibold\"\r\n            >\r\n              Error: Incorrect username or password. Please try again.\r\n            </div>\r\n        }\r\n        <form className=\"bg-white rounded-lg shadow-xl p-8\" onSubmit={handleSubmit} aria-label=\"Sign in form\">\r\n          <div className=\"space-y-6\">\r\n            <div className=\"text-center mb-8\">\r\n              <span className=\"text-3xl font-bold text-amber-700\">Better Bake</span>\r\n              <h1 className=\"text-2xl font-semibold mt-2\">Sign In</h1>\r\n            </div>\r\n            <div>\r\n              <label htmlFor=\"username\" className=\"sr-only\">Username</label>\r\n              <input \r\n                data-testid=\"username-input\"\r\n                type=\"text\" \r\n                id=\"username\" \r\n                name=\"username\" \r\n                placeholder=\"Username\" \r\n                ref={usernameRef}\r\n                onChange={handleChange}\r\n                disabled={isLoading}\r\n                required\r\n                aria-required=\"true\"\r\n                aria-invalid={error || errorUserPwd}\r\n                className=\"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent disabled:opacity-50 disabled:cursor-not-allowed\"\r\n              />\r\n            </div>\r\n            <div>\r\n              <label htmlFor=\"pwd\" className=\"sr-only\">Password</label>\r\n              <input \r\n                data-testid=\"password-input\"\r\n                type=\"password\" \r\n                id=\"pwd\" \r\n                name=\"pwd\" \r\n                placeholder=\"Password\" \r\n                ref={passwordRef}\r\n                onChange={handleChange}\r\n                disabled={isLoading}\r\n                required\r\n                aria-required=\"true\"\r\n                aria-invalid={error || errorUserPwd}\r\n                className=\"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent disabled:opacity-50 disabled:cursor-not-allowed\"\r\n              />\r\n            </div>\r\n            <div className=\"flex gap-4\">\r\n              <button \r\n                data-testid=\"submit-button\" \r\n                className=\"flex-1 bg-amber-700 hover:bg-amber-800 text-white font-bold py-3 px-6 rounded-lg shadow-lg transition-all active:scale-95 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-amber-700 disabled:active:scale-100\" \r\n                type=\"submit\"\r\n                disabled={isLoading}\r\n              >\r\n                {isLoading ? (\r\n                  <span className=\"flex items-center justify-center\">\r\n                    <svg className=\"animate-spin -ml-1 mr-2 h-4 w-4 text-white\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\">\r\n                      <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\"></circle>\r\n                      <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\r\n                    </svg>\r\n                    Signing in...\r\n                  </span>\r\n                ) : (\r\n                  'Submit'\r\n                )}\r\n              </button>\r\n              <button \r\n                data-testid=\"demo-button\" \r\n                className=\"flex-1 bg-gray-600 hover:bg-gray-700 text-white font-bold py-3 px-6 rounded-lg shadow-lg transition-all active:scale-95 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-gray-600 disabled:active:scale-100\" \r\n                type=\"button\" \r\n                onClick={handleDemoLogin}\r\n                disabled={isLoading}\r\n              >\r\n                {isLoading ? 'Loading...' : 'Demo'}\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  );\r\n};  \r\n\r\nexport default LoginPage;"],"names":["LoginPage","state","useLocation","dispatch","useAppDispatch","users","useAppSelector","success","setSuccess","useState","error","setError","errorUserPwd","setErrorUserPwd","isLoading","setIsLoading","usernameRef","useRef","passwordRef","useEffect","handleChange","e","handleSubmit","username","password","user","setAuthedUser","handleDemoLogin","demoUser","jsxs","jsx","Navigate"],"mappings":"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"}